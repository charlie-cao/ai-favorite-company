<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>浏览器历史记录</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- 主容器 -->
    <div class="main-container">
        <!-- 头部区域 -->
        <div class="header">
            <div class="header-content">
                <h1>
                    <svg fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                    </svg>
                    浏览器历史记录
                </h1>
                <div class="header-badge">
                    History Viewer
                </div>
            </div>
            
            <!-- 搜索框 -->
            <div class="search-container">
                <div class="search-input-wrapper">
                    <input type="text" id="searchInput" 
                           placeholder="搜索标题或网址..." 
                           class="search-input">
                    <svg class="search-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
                    </svg>
                </div>
                <button id="searchBtn" class="search-btn">
                    搜索
                </button>
            </div>
        </div>
        
        <!-- 控制栏 -->
        <div class="controls">
            <div class="control-group">
                <label class="control-label">时间:</label>
                <select id="timeRange" class="control-select">
                    <option value="1">最近1天</option>
                    <option value="7">最近7天</option>
                    <option value="30" selected>最近30天</option>
                    <option value="365">最近1年</option>
                    <option value="0">全部</option>
                </select>
            </div>
            
            <div class="control-group">
                <label class="control-label">每页:</label>
                <select id="pageSize" class="control-select">
                    <option value="10">10条</option>
                    <option value="20" selected>20条</option>
                    <option value="50">50条</option>
                    <option value="100">100条</option>
                </select>
            </div>
        </div>
        
        <!-- 统计和导出 -->
        <div class="stats-bar">
            <span id="totalCount" class="stats-text">共 0 条记录</span>
            <button id="exportBtn" class="export-btn">
                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                </svg>
                导出数据
            </button>
        </div>
        
        <!-- 历史记录列表 -->
        <div class="history-container" id="historyList">
            <div class="status-container">
                <div class="status-content">
                    <svg class="loading-spinner" fill="none" viewBox="0 0 24 24">
                        <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                        <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                    </svg>
                    <div class="status-title loading-title">正在加载历史记录...</div>
                </div>
            </div>
        </div>
        
        <!-- 分页控制 -->
        <div class="pagination" id="pagination">
            <button id="prevBtn" class="page-btn" disabled>
                上一页
            </button>
            
            <span class="page-info">
                第 <span id="currentPage" class="current-page">1</span> 页，共 <span id="totalPages" class="current-page">1</span> 页
            </span>
            
            <button id="nextBtn" class="page-btn" disabled>
                下一页
            </button>
        </div>
    </div>
    
    <!-- 导出模态框 -->
    <div id="exportModal" class="modal" style="display: none;">
        <div class="modal-dialog">
            <!-- 模态框头部 -->
            <div class="modal-header">
                <h3 class="modal-title">
                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                    </svg>
                    导出历史记录
                </h3>
                <button id="closeModal" class="modal-close">×</button>
            </div>
            
            <!-- 模态框内容 -->
            <div class="modal-body">
                <!-- 导出格式选择 -->
                <div class="option-section">
                    <label class="option-label">导出格式</label>
                    <div class="option-grid format-grid">
                        <label class="option-item selected" data-format="csv">
                            <input type="radio" name="format" value="csv" checked style="display: none;">
                            <div class="radio-indicator">
                                <div class="radio-dot"></div>
                            </div>
                            <span class="option-text">CSV</span>
                        </label>
                        <label class="option-item" data-format="json">
                            <input type="radio" name="format" value="json" style="display: none;">
                            <div class="radio-indicator">
                                <div class="radio-dot"></div>
                            </div>
                            <span class="option-text">JSON</span>
                        </label>
                        <label class="option-item" data-format="txt">
                            <input type="radio" name="format" value="txt" style="display: none;">
                            <div class="radio-indicator">
                                <div class="radio-dot"></div>
                            </div>
                            <span class="option-text">TXT</span>
                        </label>
                    </div>
                </div>
                
                <!-- 导出范围选择 -->
                <div class="option-section">
                    <label class="option-label">导出范围</label>
                    <div class="option-grid range-grid">
                        <label class="option-item selected" data-range="current">
                            <input type="radio" name="range" value="current" checked style="display: none;">
                            <div class="radio-indicator">
                                <div class="radio-dot"></div>
                            </div>
                            <span class="option-text">当前筛选结果</span>
                        </label>
                        <label class="option-item" data-range="all">
                            <input type="radio" name="range" value="all" style="display: none;">
                            <div class="radio-indicator">
                                <div class="radio-dot"></div>
                            </div>
                            <span class="option-text">全部历史记录</span>
                        </label>
                    </div>
                </div>
                
                <!-- 字段选择 -->
                <div class="option-section">
                    <label class="option-label">包含字段</label>
                    <div class="option-grid field-grid">
                        <label class="option-item selected" data-field="title">
                            <input type="checkbox" name="fields" value="title" checked style="display: none;">
                            <div class="checkbox-indicator">
                                <svg class="checkbox-check" fill="currentColor" viewBox="0 0 20 20">
                                    <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                                </svg>
                            </div>
                            <span class="option-text">标题</span>
                        </label>
                        <label class="option-item selected" data-field="url">
                            <input type="checkbox" name="fields" value="url" checked style="display: none;">
                            <div class="checkbox-indicator">
                                <svg class="checkbox-check" fill="currentColor" viewBox="0 0 20 20">
                                    <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                                </svg>
                            </div>
                            <span class="option-text">网址</span>
                        </label>
                        <label class="option-item selected" data-field="visitTime">
                            <input type="checkbox" name="fields" value="visitTime" checked style="display: none;">
                            <div class="checkbox-indicator">
                                <svg class="checkbox-check" fill="currentColor" viewBox="0 0 20 20">
                                    <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                                </svg>
                            </div>
                            <span class="option-text">访问时间</span>
                        </label>
                        <label class="option-item selected" data-field="visitCount">
                            <input type="checkbox" name="fields" value="visitCount" checked style="display: none;">
                            <div class="checkbox-indicator">
                                <svg class="checkbox-check" fill="currentColor" viewBox="0 0 20 20">
                                    <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                                </svg>
                            </div>
                            <span class="option-text">访问次数</span>
                        </label>
                    </div>
                </div>
                
                <!-- 进度显示 -->
                <div id="exportProgress" class="progress-container" style="display: none;">
                    <div class="progress-info">
                        <span id="progressText" class="progress-text">准备导出...</span>
                        <span id="progressPercent" class="progress-percent">0%</span>
                    </div>
                    <div class="progress-bar">
                        <div id="progressFill" class="progress-fill" style="width: 0%"></div>
                    </div>
                    <div class="progress-details">
                        <span id="processedCount">0</span> / <span id="totalExportCount">0</span> 条记录
                    </div>
                </div>
            </div>
            
            <!-- 模态框底部 -->
            <div class="modal-footer">
                <button id="cancelExport" class="btn btn-secondary">取消</button>
                <button id="startExport" class="btn btn-primary">
                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                    </svg>
                    开始导出
                </button>
            </div>
        </div>
    </div>
    
    <script src="popup.js"></script>
</body>
</html>