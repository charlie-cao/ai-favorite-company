# 🤖 AI配置管理使用指南

## 🚀 功能概述

AI配置管理系统为浏览器历史记录管理系统添加了强大的AI功能，支持：

- **多种AI服务**: Ollama、OpenAI、Anthropic等
- **灵活配置管理**: 创建、编辑、删除AI模型配置
- **Agent模板系统**: 预设提示词模板，快速部署AI应用
- **连接测试工具**: 验证AI服务可用性和性能
- **实时交互测试**: 测试AI模型响应效果

## 🎯 访问AI配置界面

### 方法1：从主界面访问
1. 启动浏览器历史记录管理系统
2. 访问 http://localhost:8000
3. 点击导航栏的 "AI配置" 按钮

### 方法2：直接访问
- 直接访问 http://localhost:8000/ai

## 🔧 AI配置管理

### 创建新的AI配置

1. **点击"添加配置"按钮**
2. **填写配置信息**：
   - **配置名称**: 唯一标识符，如 "本地Ollama"
   - **类型**: 选择AI服务类型（Ollama/OpenAI/Anthropic）
   - **服务地址**: API端点，如 http://localhost:11434
   - **API密钥**: 某些服务需要（可选）
   - **模型名称**: 具体模型，如 llama2、mistral等
   - **最大Token**: 响应长度限制（默认2048）
   - **温度**: 创造性参数（0-2，默认0.7）
   - **启用状态**: 是否激活此配置

3. **点击"保存"完成创建**

### Ollama配置示例
```
配置名称: 本地Llama2
类型: ollama
服务地址: http://localhost:11434
模型名称: llama2
最大Token: 2048
温度: 0.7
```

### OpenAI配置示例
```
配置名称: OpenAI-GPT4
类型: openai
服务地址: https://api.openai.com/v1
API密钥: sk-xxxxxxxxxxxxxxxx
模型名称: gpt-4
最大Token: 4096
温度: 0.7
```

## 🤖 Agent模板管理

### 创建Agent模板

1. **切换到"Agent模板"标签页**
2. **点击"添加模板"按钮**
3. **填写模板信息**：
   - **模板名称**: 如 "历史分析助手"
   - **描述**: 模板功能说明
   - **关联AI配置**: 选择要使用的AI配置
   - **系统提示词**: 定义Agent角色和行为
   - **用户提示词模板**: 用户输入的处理模板

4. **保存模板**

### Agent模板示例

#### 历史分析助手
```
模板名称: 历史分析助手
描述: 分析用户浏览历史，提供个性化洞察
关联配置: 本地Llama2

系统提示词:
你是一个专业的数字行为分析师，专门分析用户的浏览历史。
你需要：
1. 理解用户的兴趣偏好
2. 发现浏览模式和趋势
3. 提供有价值的洞察和建议
4. 保持客观和专业

用户提示词模板:
请分析以下浏览历史数据：{input}

请提供：
1. 主要兴趣领域分析
2. 浏览行为模式
3. 时间分布特征
4. 个性化建议
```

#### 内容总结助手
```
模板名称: 内容总结助手
描述: 为网页内容生成简洁摘要
关联配置: OpenAI-GPT4

系统提示词:
你是一个专业的内容总结专家。
请为用户提供：
- 准确、简洁的内容摘要
- 关键信息提取
- 结构化的信息展示

用户提示词模板:
请为以下网页内容生成摘要：

标题：{title}
网址：{url}
内容：{input}

请提供：
1. 一句话摘要
2. 关键要点（3-5条）
3. 适用场景或价值
```

## 🔍 测试工具使用

### Ollama连接测试

1. **切换到"测试工具"标签页**
2. **在"Ollama连接测试"区域填写**：
   - **服务地址**: http://localhost:11434
   - **测试模型**: llama2（可选）
3. **点击"测试连接"**
4. **查看测试结果**：
   - 连接状态
   - 可用模型列表
   - 测试响应示例

### AI模型测试

1. **选择要测试的AI配置**
2. **输入测试提示词**，如：
   ```
   你好，请介绍一下你自己
   ```
   或
   ```
   请分析以下数据的趋势：[1,3,5,7,9]
   ```
3. **点击"发送测试"**
4. **查看AI响应结果**

## 📋 使用场景示例

### 1. 浏览历史智能分析
```python
# 创建配置：本地Ollama + Llama2
# 创建Agent：历史分析助手
# 输入：用户最近一周的浏览记录
# 输出：兴趣偏好分析、时间模式、个性化推荐
```

### 2. 网页内容自动摘要
```python
# 创建配置：OpenAI GPT-4
# 创建Agent：内容总结助手  
# 输入：网页标题和内容
# 输出：结构化摘要和关键信息
```

### 3. 搜索查询优化
```python
# 创建Agent：搜索优化助手
# 系统提示词：帮助用户改进搜索查询
# 输入：原始搜索意图
# 输出：优化的搜索关键词和策略
```

## ⚠️ 注意事项

### Ollama配置
1. **确保Ollama服务运行**：
   ```bash
   ollama serve
   ```

2. **下载所需模型**：
   ```bash
   ollama pull llama2
   ollama pull mistral
   ```

3. **检查服务状态**：
   ```bash
   curl http://localhost:11434/api/tags
   ```

### OpenAI配置
1. **获取API密钥**: 访问 https://platform.openai.com/api-keys
2. **设置计费**: 确保账户有可用余额
3. **注意速率限制**: 根据订阅计划调整使用频率

### 安全建议
1. **API密钥保护**: 不要在公共环境暴露API密钥
2. **本地存储**: 所有配置存储在本地数据库中
3. **网络安全**: 确保AI服务的网络连接安全

## 🛠️ 故障排除

### 常见问题

**1. Ollama连接失败**
- 检查Ollama服务是否启动
- 确认端口11434未被占用
- 验证防火墙设置

**2. 模型不可用**
- 确认模型已下载：`ollama list`
- 检查模型名称拼写
- 尝试重新拉取模型

**3. API密钥错误**
- 验证密钥格式和有效性
- 检查账户余额和权限
- 确认服务端点正确

**4. 响应超时**
- 调整超时设置
- 减少输入长度
- 检查网络连接

### 日志查看
服务运行时会输出详细日志：
```
2025-08-09 09:30:26 - INFO - 测试Ollama连接: http://localhost:11434
2025-08-09 09:30:27 - INFO - Ollama连接成功，发现3个可用模型
```

## 🎯 高级用法

### 1. 批量配置导入
```python
# 将来支持的功能
# 从JSON文件导入多个AI配置
# 支持配置模板和预设
```

### 2. 自定义提示词变量
```python
# Agent模板支持变量替换
# {user_name} - 用户名称
# {current_time} - 当前时间
# {history_count} - 历史记录数量
```

### 3. 工作流集成
```python
# 将AI功能集成到浏览历史分析工作流
# 自动化数据处理和洞察生成
# 定时任务和批量处理
```

---

**享受AI增强的浏览历史管理体验！** 🚀