# 🚀 浏览器历史记录管理系统

## 📁 项目结构

```
google_fav/
├── chrome_extension/          # Chrome扩展插件文件
│   ├── manifest.json         # 扩展清单文件
│   ├── popup.html           # 扩展弹窗界面
│   ├── popup.js             # 扩展功能逻辑
│   ├── styles.css           # 样式文件(备用)
│   ├── icon16.png           # 16x16图标
│   ├── icon32.png           # 32x32图标
│   ├── icon48.png           # 48x48图标
│   ├── icon128.png          # 128x128图标
│   └── alternative_icons/   # 备用图标
├── backend/                  # 后台API服务
│   ├── server.py            # FastAPI服务主文件
│   ├── requirements.txt     # Python依赖
│   ├── browser_history.db   # SQLite数据库(自动生成)
│   └── 启动本地服务.md      # 详细服务说明
└── README.md                # 项目说明
```

## 🎯 功能特性

### Chrome扩展功能
- ✅ **历史记录查看**: 分页显示浏览器历史记录
- ✅ **智能搜索**: 按标题或网址搜索历史记录
- ✅ **时间筛选**: 支持1天、7天、30天、1年、全部时间范围
- ✅ **数据导出**: 一键导出CSV格式历史记录
- ✅ **同步到本地**: 将历史记录同步到本地SQLite数据库
- ✅ **现代UI**: 美观的渐变界面设计

### 后台API服务
- ✅ **RESTful API**: 标准HTTP接口
- ✅ **增量存储**: 自动去重，只存储新记录
- ✅ **批量同步**: 高效批量处理历史记录
- ✅ **统计信息**: 同步数据统计和分析
- ✅ **数据验证**: 严格的数据格式验证
- ✅ **详细日志**: 完整的操作和错误日志

## 🛠️ 安装和使用

### 1. 安装Chrome扩展

1. 打开Chrome浏览器，进入 `chrome://extensions/`
2. 启用"开发者模式"
3. 点击"加载已解压的扩展程序"
4. 选择 `chrome_extension` 文件夹
5. 扩展安装成功后会在工具栏显示图标

### 2. 启动后台服务

```bash
# 进入后台服务目录
cd backend

# 安装Python依赖(首次运行)
pip install -r requirements.txt

# 启动API服务
python server.py
```

服务启动后会显示：
```
🚀 启动浏览器历史记录本地API服务
📊 服务地址: http://localhost:8000
📚 API文档: http://localhost:8000/docs
```

### 3. 使用扩展功能

1. **查看历史**: 点击扩展图标打开历史记录查看器
2. **搜索记录**: 在搜索框输入关键词搜索
3. **筛选时间**: 选择不同的时间范围
4. **导出数据**: 点击"导出数据"按钮下载CSV文件
5. **同步到本地**: 点击"同步到本地"按钮将数据保存到本地数据库

## 📊 API接口

访问 http://localhost:8000/docs 查看完整的API文档

### 主要接口
- `POST /sync-single` - 同步单条历史记录
- `POST /sync-batch` - 批量同步历史记录
- `GET /stats` - 获取统计信息
- `GET /history` - 查询历史记录

## 🔧 问题排查

### 1. 扩展无法加载
- 确保所有文件都在 `chrome_extension` 文件夹中
- 检查 `manifest.json` 语法是否正确
- 在扩展管理页面查看错误信息

### 2. 同步失败
- 确保后台服务已启动 (http://localhost:8000)
- 检查控制台错误信息
- 查看后台服务日志

### 3. 界面显示异常
- 刷新扩展页面
- 重新加载扩展
- 检查控制台CSS错误

### 4. 数据库问题
- 检查 `backend/browser_history.db` 文件权限
- 查看服务日志中的数据库错误信息

## 🎨 自定义配置

### 修改扩展图标
使用项目中的 `generate_icons.py` 脚本生成新图标：
```bash
cd chrome_extension
python generate_icons.py "你的文字" --theme blue --style modern
```

### 修改API端口
编辑 `backend/server.py` 文件中的端口配置：
```python
uvicorn.run("server:app", host="127.0.0.1", port=8080)  # 改为8080端口
```

同时更新 `chrome_extension/popup.js` 中的API地址：
```javascript
const response = await fetch('http://localhost:8080/sync-batch', {
```

## 📈 数据分析

访问 http://localhost:8000/stats 获取同步统计信息，包括：
- 总记录数
- 唯一网站数
- 最早/最新访问时间
- 同步次数和数量

## 🔒 安全说明

- 本服务仅在本地运行，数据不会上传到外部服务器
- 数据库文件存储在本地，请定期备份
- API默认允许所有来源访问，生产环境请限制CORS设置

## 🚀 下一步扩展

- [ ] 添加Web管理界面
- [ ] 支持数据导入功能
- [ ] 添加访问频率分析
- [ ] 支持标签和分类管理
- [ ] 添加全文搜索功能
- [ ] 支持多浏览器数据同步

## 📞 技术支持

遇到问题请查看：
1. 后台服务日志输出
2. Chrome扩展控制台错误
3. 网络请求状态
4. 数据库文件完整性

---

**享受你的浏览历史管理体验！** 🎉